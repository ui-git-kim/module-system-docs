---
title: Usage
description: How to use picker components, hooks, and API endpoints from the Pickers module
sidebar:
  order: 2
---

import { Aside, Tabs, TabItem } from '@astrojs/starlight/components';

After installation, the Pickers module provides 10 picker components, 3 hooks, a colour utility library, and a backend REST API. All components are exported from the feature barrel file.

---

## Importing Components

```typescript
import {
  ColorPicker,
  IconPicker,
  DatePicker,
  DateRangePicker,
  TimePicker,
  TimezonePicker,
  ImagePicker,
  EmojiPicker,
  FontPicker,
  AvatarPicker,
} from '@/features/pickers';
```

---

## Picker Components

Every picker follows a consistent pattern:

- **Controlled component** — You pass `value` and `onChange`
- **Optional `profile` prop** — Loads configuration from an admin-managed profile
- **Optional `mode` prop** — `'inline'` or `'popover'` (some also support `'dialog'`)
- **Optional `disabled` and `className` props** — Standard UI controls

### ColorPicker

Full-featured colour picker with solid, gradient, and image fill modes.

```tsx
import { useState } from 'react';
import { ColorPicker } from '@/features/pickers';
import type { ColorPickerValue } from '@/features/pickers';

function MyComponent() {
  const [color, setColor] = useState<string | ColorPickerValue>('#3b82f6');

  return (
    <ColorPicker
      value={color}
      onChange={setColor}
      label="Brand colour"
      enabledTabs={['solid', 'gradient']}
      enableAlpha={true}
      enableEyedropper={true}
      format="hex"
      mode="popover"
    />
  );
}
```

**Key props:**

| Prop | Type | Description |
|------|------|-------------|
| `value` | `string \| ColorPickerValue` | Current colour (hex string or structured value) |
| `onChange` | `(value: string \| ColorPickerValue) => void` | Change handler |
| `enabledTabs` | `('solid' \| 'gradient' \| 'image')[]` | Which fill modes to show |
| `presetColors` | `string[]` | Preset swatch colours |
| `enableAlpha` | `boolean` | Show alpha/opacity slider |
| `enableEyedropper` | `boolean` | Show eyedropper tool (browser support required) |
| `format` | `'hex' \| 'rgb' \| 'hsl' \| 'oklch'` | Display format |
| `profile` | `string` | Profile name to load config from |
| `mode` | `'inline' \| 'popover'` | Display mode |

### IconPicker

Browse and select from the full Lucide icon set with search and category filtering.

```tsx
import { useState } from 'react';
import { IconPicker } from '@/features/pickers';

function MyComponent() {
  const [icon, setIcon] = useState<string | null>(null);

  return (
    <IconPicker
      value={icon}
      onChange={setIcon}
      label="Choose an icon"
      mode="dialog"
      allowNone={true}
    />
  );
}
```

**Key props:**

| Prop | Type | Description |
|------|------|-------------|
| `value` | `string \| null` | Selected icon name (PascalCase, e.g. `'Activity'`) |
| `onChange` | `(icon: string \| null) => void` | Change handler |
| `enabledCategories` | `string[]` | Categories to show (empty = all) |
| `allowNone` | `boolean` | Allow clearing selection |
| `mode` | `'inline' \| 'popover' \| 'dialog'` | Display mode |

### DatePicker

Calendar-based date selection.

```tsx
import { useState } from 'react';
import { DatePicker } from '@/features/pickers';

function MyComponent() {
  const [date, setDate] = useState<Date | null>(null);

  return (
    <DatePicker
      value={date}
      onChange={setDate}
      label="Due date"
      minDate={new Date()}
      format="dd/MM/yyyy"
      mode="popover"
    />
  );
}
```

**Key props:**

| Prop | Type | Description |
|------|------|-------------|
| `value` | `Date \| string \| null` | Selected date |
| `onChange` | `(date: Date \| null) => void` | Change handler |
| `minDate` | `Date` | Earliest selectable date |
| `maxDate` | `Date` | Latest selectable date |
| `isDateDisabled` | `(date: Date) => boolean` | Custom disable predicate |
| `format` | `string` | Date format string |

### DateRangePicker

Dual-calendar range selection with preset ranges.

```tsx
import { useState } from 'react';
import { DateRangePicker } from '@/features/pickers';
import type { DateRange } from '@/features/pickers';

function MyComponent() {
  const [range, setRange] = useState<DateRange>({ from: null, to: null });

  return (
    <DateRangePicker
      value={range}
      onChange={setRange}
      label="Report period"
      maxRange={90}
      mode="popover"
    />
  );
}
```

### TimePicker

Hour/minute/period selection.

```tsx
import { useState } from 'react';
import { TimePicker } from '@/features/pickers';
import type { TimeValue } from '@/features/pickers';

function MyComponent() {
  const [time, setTime] = useState<TimeValue | string | null>(null);

  return (
    <TimePicker
      value={time}
      onChange={setTime}
      label="Meeting time"
      hourFormat={12}
      minuteStep={15}
    />
  );
}
```

### TimezonePicker

Searchable timezone dropdown grouped by region.

```tsx
import { useState } from 'react';
import { TimezonePicker } from '@/features/pickers';

function MyComponent() {
  const [tz, setTz] = useState<string | null>(null);

  return (
    <TimezonePicker
      value={tz}
      onChange={setTz}
      label="Timezone"
      showOffset={true}
    />
  );
}
```

### ImagePicker

Drag-and-drop image upload with preview and validation.

```tsx
import { useState } from 'react';
import { ImagePicker } from '@/features/pickers';

function MyComponent() {
  const [image, setImage] = useState<string | File | null>(null);

  return (
    <ImagePicker
      value={image}
      onChange={(file, preview) => setImage(file)}
      label="Upload photo"
      accept={['image/jpeg', 'image/png']}
      maxFileSize={2 * 1024 * 1024}
    />
  );
}
```

### EmojiPicker

Categorised emoji grid with search.

```tsx
import { EmojiPicker } from '@/features/pickers';

function MyComponent() {
  return (
    <EmojiPicker
      onSelect={(emoji) => console.log('Selected:', emoji)}
      enableSkinTones={true}
      showRecent={true}
      mode="popover"
    />
  );
}
```

<Aside type="note">
  The EmojiPicker uses `onSelect` rather than `onChange` because it fires on each emoji click rather than tracking a single controlled value.
</Aside>

### FontPicker

Google Fonts browser with live preview.

```tsx
import { useState } from 'react';
import { FontPicker } from '@/features/pickers';

function MyComponent() {
  const [font, setFont] = useState<string | null>(null);

  return (
    <FontPicker
      value={font}
      onChange={setFont}
      label="Heading font"
      showPreview={true}
      mode="popover"
    />
  );
}
```

### AvatarPicker

Composed picker supporting upload, icon, and initials modes.

```tsx
import { useState } from 'react';
import { AvatarPicker } from '@/features/pickers';
import type { AvatarValue } from '@/features/pickers';

function MyComponent() {
  const [avatar, setAvatar] = useState<AvatarValue | null>(null);

  return (
    <AvatarPicker
      value={avatar}
      onChange={setAvatar}
      label="Profile avatar"
      enabledModes={['upload', 'icon', 'initials']}
      size={96}
    />
  );
}
```

---

## Hooks

### usePickerProfile

Loads a named picker profile from the backend and provides a `getConfig` helper that merges defaults, profile config, and overrides.

```typescript
import { usePickerProfile } from '@/features/pickers';

function MyPicker() {
  const { profile, loading, error, getConfig } = usePickerProfile('marketing');

  // Get merged config for a specific picker type
  const colorConfig = getConfig('colorPicker', {
    enableAlpha: false,  // override this one setting
  });

  // colorConfig is fully typed as ColorPickerConfig
}
```

**Return values:**

| Property | Type | Description |
|----------|------|-------------|
| `profile` | `PickerProfile \| null` | The loaded profile (or null) |
| `loading` | `boolean` | Loading state |
| `error` | `string \| null` | Error message (if fetch failed) |
| `getConfig` | `(picker, overrides?) => Config` | Merge helper — returns typed config |

Profile responses are cached in memory. Call `clearPickerProfileCache()` to invalidate.

### useColorPicker

State management hook for the ColorPicker component. Handles HSL/hex synchronisation, gradient stops, eyedropper, and canvas interaction.

```typescript
import { useColorPicker } from '@/features/pickers';

const colorState = useColorPicker({
  value: '#3b82f6',
  onChange: (newValue) => console.log(newValue),
  enableAlpha: true,
});

// Access: colorState.hsl, colorState.hexValue,
//         colorState.gradient, colorState.activeTab, etc.
```

### useIconPicker

Provides search, category filtering, and the full icon dataset for building custom icon picker UIs.

```typescript
import { useIconPicker } from '@/features/pickers';

const {
  search, setSearch,
  category, setCategory,
  categories, categoryLabels,
  icons,       // filtered IconData[]
  totalCount,  // total available icons
} = useIconPicker();
```

### IconRenderer

A utility component for rendering a Lucide icon by name string:

```tsx
import { IconRenderer } from '@/features/pickers';

<IconRenderer icon="Activity" className="h-5 w-5" />
```

---

## Colour Utilities

The module includes a comprehensive colour utility library at `features/pickers/lib/color-utils.ts`:

| Function | Description |
|----------|-------------|
| `hexToRgb` / `rgbToHex` | Hex to RGB conversion |
| `hexToHsl` / `hslToHex` | Hex to HSL conversion |
| `hexToOklch` / `oklchToHex` | Hex to OKLCH conversion |
| `rgbToHsl` / `hslToRgb` | RGB to HSL conversion |
| `rgbToOklch` / `oklchToRgb` | RGB to OKLCH conversion |
| `isValidHex` | Validate hex colour string |
| `normalizeHex` | Normalise 3/4 digit hex to 6/8 digit |
| `formatHex` / `formatRgb` / `formatHsl` / `formatOklch` | Format colour for display |
| `getPerceivedBrightness` | Get perceived brightness (0-255) |
| `getContrastColor` | Get contrasting text colour (black or white) |

```typescript
import {
  hexToHsl,
  hslToHex,
  getContrastColor,
  isValidHex,
} from '@/features/pickers/lib/color-utils';

const hsl = hexToHsl('#3b82f6');      // { h: 217, s: 91, l: 60 }
const hex = hslToHex(hsl);            // '#3b82f6'
const textColor = getContrastColor('#3b82f6'); // '#ffffff'
```

---

## Backend API

All endpoints are mounted at `/api/v1/pickers` and require authentication.

### Endpoints

| Method | Path | Description |
|--------|------|-------------|
| `GET` | `/profiles` | List all profiles (sorted: default first, then alphabetical) |
| `GET` | `/profiles/default` | Get the default profile |
| `GET` | `/profiles/by-name/:name` | Get a profile by its unique name |
| `GET` | `/profiles/:id` | Get a profile by ID |
| `POST` | `/profiles` | Create a new profile |
| `PATCH` | `/profiles/:id` | Update an existing profile |
| `DELETE` | `/profiles/:id` | Delete a profile |

### Request/Response Examples

<Tabs>
  <TabItem label="List Profiles">
    ```bash
    GET /api/v1/pickers/profiles
    ```
    ```json
    [
      {
        "id": "clx1abc...",
        "name": "default",
        "description": "Standard picker configuration",
        "config": { "colorPicker": { "enableAlpha": true } },
        "isDefault": true,
        "createdAt": "2025-01-15T10:00:00.000Z",
        "updatedAt": "2025-01-15T10:00:00.000Z"
      }
    ]
    ```
  </TabItem>
  <TabItem label="Create Profile">
    ```bash
    POST /api/v1/pickers/profiles
    Content-Type: application/json
    ```
    ```json
    {
      "name": "marketing-brand",
      "description": "Marketing team brand colours only",
      "config": {
        "colorPicker": {
          "enabledTabs": ["solid"],
          "presetColors": ["#1a1a2e", "#16213e", "#0f3460", "#e94560"],
          "enableAlpha": false,
          "enableEyedropper": false,
          "defaultFormat": "hex"
        }
      },
      "isDefault": false
    }
    ```
    Response: `201 Created` with the created profile object.
  </TabItem>
  <TabItem label="Update Profile">
    ```bash
    PATCH /api/v1/pickers/profiles/clx1abc...
    Content-Type: application/json
    ```
    ```json
    {
      "config": {
        "colorPicker": {
          "enableAlpha": true
        }
      }
    }
    ```
    Config updates are **merged** — you only need to send the fields you want to change.
  </TabItem>
  <TabItem label="Delete Profile">
    ```bash
    DELETE /api/v1/pickers/profiles/clx1abc...
    ```
    Response: `204 No Content`
  </TabItem>
</Tabs>

---

## Showcase Page

The module includes a showcase page at `/pickers` that demonstrates all 10 pickers with live state display. This page is useful for testing configuration and for developers to see available components.

The showcase page is registered as a protected route and appears in the sidebar automatically.

---

## Next Steps

- [Configuration](/modules/pickers/configuration/) — Profile defaults and database schema
- [Integration](/modules/pickers/integration/) — Service registry, hooks, and cross-module usage
