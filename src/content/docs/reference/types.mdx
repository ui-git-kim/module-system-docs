---
title: Types Reference
description: Complete TypeScript type definitions for the starter template
sidebar:
  order: 2
---

import { Aside } from '@astrojs/starlight/components';

All TypeScript interfaces and types used across the starter template. For registry-specific types, see [Registries API](/reference/registries-api/).

---

## Base Types

### RegistryItem

Base interface for all collection registry items.

```typescript
// frontend/src/config/base.registry.ts
interface RegistryItem {
  id: string;
  order?: number;
}
```

### RegistrationOptions

Options for the `register()` method on `BaseRegistry`.

```typescript
interface RegistrationOptions {
  allowReplace?: boolean;  // Default: false
  silent?: boolean;        // Default: false
}
```

---

## User Types

### UserRole

```typescript
// backend/src/features/user/user.types.ts
type UserRole = 'user' | 'admin' | 'managed';

const USER_ROLES: readonly UserRole[] = ['user', 'admin', 'managed'];

function isValidRole(role: string): role is UserRole;
```

### UserProfile

The complete user record returned from the API.

```typescript
interface UserProfile {
  id: string;                    // Neon Auth user ID (UUID)
  email: string;
  role: UserRole;
  name: string | null;
  avatarUrl: string | null;
  bio: string | null;
  preferences: UserPreferences;
  createdAt: Date;
  updatedAt: Date;
}
```

### UserPreferences

Stored as JSON in the database. Extensible by modules.

```typescript
interface UserPreferences {
  // Appearance
  theme?: 'light' | 'dark' | 'system';

  // Locale
  timezone?: string;     // IANA timezone (e.g., 'America/New_York')
  language?: string;     // Language code (e.g., 'en-US')

  // Avatar
  avatarColor?: string;  // Hex color (e.g., '#3b82f6')

  // Dashboard
  dashboardWidgets?: DashboardWidgetPreference[];

  // Email Notifications
  emailSecurityAlerts?: boolean;
  emailProductUpdates?: boolean;
  emailWeeklyDigest?: boolean;
  emailMarketing?: boolean;

  // Feature modules add their preferences here
}
```

### DashboardWidgetPreference

User preference for a dashboard widget (stored in `UserPreferences.dashboardWidgets`).

```typescript
interface DashboardWidgetPreference {
  id: string;
  visible: boolean;
  order?: number;
  size?: string;
}
```

---

## API Input Types

### UpdateProfileInput

Used by `PATCH /api/v1/user`.

```typescript
interface UpdateProfileInput {
  name?: string;
  bio?: string;
  avatarUrl?: string;  // URL or base64 data URI
}
```

### UpdatePreferencesInput

Used by `PATCH /api/v1/user/preferences`. Partial update â€” merges with existing preferences.

```typescript
interface UpdatePreferencesInput {
  theme?: 'light' | 'dark' | 'system';
  timezone?: string;
  language?: string;
  avatarColor?: string;
  dashboardWidgets?: DashboardWidgetPreference[];
  emailSecurityAlerts?: boolean;
  emailProductUpdates?: boolean;
  emailWeeklyDigest?: boolean;
  emailMarketing?: boolean;
  // Feature modules add their fields here
}
```

---

## Zod Validation Schemas

### UpdateProfileSchema

```typescript
const UpdateProfileSchema = z.object({
  name: z.string().max(255).optional(),
  bio: z.string().max(5000).optional(),
  avatarUrl: z.string()
    .max(7 * 1024 * 1024)
    .refine(/* URL or base64 image */)
    .optional(),
}).strict();
```

### UpdatePreferencesSchema

```typescript
const UpdatePreferencesSchema = z.object({
  theme: z.enum(['light', 'dark', 'system']).optional(),
  timezone: z.string().max(100).optional(),
  language: z.string().max(20).optional(),
  avatarColor: z.string().regex(/^#[0-9a-fA-F]{6}$/).optional(),
  dashboardWidgets: z.array(z.object({
    id: z.string().max(100),
    visible: z.boolean(),
    order: z.number().int().min(0).max(100).optional(),
    size: z.string().max(10).optional(),
  })).max(50).optional(),
  emailSecurityAlerts: z.boolean().optional(),
  emailProductUpdates: z.boolean().optional(),
  emailWeeklyDigest: z.boolean().optional(),
  emailMarketing: z.boolean().optional(),
}).strict();
```

---

## Auth Types

### Session Data

Returned by the `useSession()` hook.

```typescript
type SessionData = {
  user: SessionUser;
  session: Session;
} | null;

interface SessionUser {
  id: string;
  name: string;
  email: string;
  emailVerified: boolean;
  image?: string | null;
  createdAt: Date;
  updatedAt: Date;
}

interface Session {
  id: string;
  token: string;
  userId: string;
  expiresAt: Date;
}
```

### Express Request Extension

Available in all backend route handlers after `requireAuth` middleware.

```typescript
declare global {
  namespace Express {
    interface Request {
      user?: {
        id: string;         // Neon Auth user ID (JWT 'sub' claim)
        email: string;      // User's email (JWT 'email' claim)
        role?: UserRole;    // Populated by requireAdmin/requireRole/attachRole
      };
    }
  }
}
```

---

## Route Types

### RouteConfig

Configuration for registering a backend API route.

```typescript
type ApiVersion = 'v1' | 'v2';

interface RouteConfig {
  path: string;
  router: Router;
  versions?: ApiVersion[];
  middleware?: RequestHandler[];
  requiresAuth?: boolean;
  feature: string;
  description?: string;
  deprecated?: boolean;
  deprecationMessage?: string;
}
```

### PublicRouteConfig

Configuration for routes that bypass authentication.

```typescript
interface PublicRouteConfig {
  path: string;
  method: 'get' | 'post' | 'put' | 'patch' | 'delete';
  handler: RequestHandler;
  description?: string;
}
```

---

## Service Types

### ServiceMetadata

```typescript
interface ServiceMetadata {
  feature: string;
  description?: string;
  version?: string;
}
```

### ServiceTypes

Extend this interface via module augmentation for type-safe `serviceRegistry.get()`.

```typescript
// In your service.registration.ts:
declare module '../../config/service.registry.js' {
  interface ServiceTypes {
    billing: typeof billingService;
  }
}
```

---

## Error Types

### AppError

Base class for all operational errors.

```typescript
class AppError extends Error {
  public readonly statusCode: number;
  public readonly isOperational: boolean;
  constructor(message: string, statusCode?: number, isOperational?: boolean);
}
```

### Error Subclasses

| Class | Status Code | Default Message |
|-------|-------------|-----------------|
| `BadRequestError` | 400 | `Bad request` |
| `UnauthorizedError` | 401 | `Unauthorised` |
| `ForbiddenError` | 403 | `Forbidden` |
| `NotFoundError` | 404 | `Not found` |
| `ConflictError` | 409 | `Conflict` |
| `TooManyRequestsError` | 429 | `Too many requests` |
| `InternalError` | 500 | `Internal server error` |
| `ServiceUnavailableError` | 503 | `Service unavailable` |

`TooManyRequestsError` has an additional `retryAfterSeconds` property.

---

## Database Types

### TransactionClient

A Prisma client that operates within a transaction.

```typescript
type TransactionClient = Omit<
  PrismaClient,
  '$connect' | '$disconnect' | '$on' | '$transaction' | '$use' | '$extends'
>;
```

### DatabaseHealthStatus

Returned by `checkDatabaseHealth()`.

```typescript
interface DatabaseHealthStatus {
  connected: boolean;
  latencyMs: number | null;
  adapter: 'neon' | 'pg';
  error?: string;
}
```

---

## Environment Variables Schema

Backend environment validated with Zod on startup:

```typescript
const envSchema = z.object({
  DATABASE_URL: z.string().min(1),
  DIRECT_DATABASE_URL: z.string().optional(),
  DATABASE_ADAPTER: z.enum(['neon', 'pg']).default('neon'),
  DEBUG_PRISMA: z.string().default('false'),
  DB_QUERY_TIMEOUT: z.coerce.number().default(10000),
  NEON_AUTH_URL: z.string().url(),
  PORT: z.coerce.number().default(3100),
  NODE_ENV: z.enum(['development', 'production', 'test']).default('development'),
  FRONTEND_URL: z.string().url().default('http://localhost:5173'),
  SHUTDOWN_TIMEOUT: z.coerce.number().default(10000),
});
```

---

## Frontend Configuration

### appConfig

```typescript
// frontend/src/config/app.config.ts
const appConfig = {
  apiUrl: string;    // Backend URL from VITE_API_URL or 'http://localhost:3100'
  appName: string;   // App name from VITE_APP_NAME or 'My App'
};
```

---

## Filter & Action Types

### Filter Types

```typescript
// Sync filter callback
type FilterCallback<T = unknown, C = unknown> = (value: T, context: C) => T;

// Async filter callback (backend only)
type AsyncFilterCallback<T = unknown, C = unknown> = (value: T, context: C) => T | Promise<T>;

interface RegisteredFilter<T = unknown, C = unknown> {
  id: string;
  callback: FilterCallback<T, C>;
  order: number;
}
```

### Action Types

```typescript
type ActionCallback<C = unknown> = (context: C) => void | Promise<void>;

interface RegisteredAction<C = unknown> {
  id: string;
  callback: ActionCallback<C>;
  order: number;
  async: boolean;
}
```

---

## Widget Types

### WidgetSize

```typescript
type WidgetSize = '1x1' | '2x1' | '1x2' | '2x2' | 'full';
```

### WidgetVisibility

User preference stored in `UserPreferences.dashboardWidgets`.

```typescript
interface WidgetVisibility {
  id: string;
  visible: boolean;
  order?: number;
  size?: string;
}
```
