---
title: Updating from Template
description: How to receive updates from the starter template
---

import { Steps, Tabs, TabItem } from '@astrojs/starlight/components';

## How It Works

Apps created with the create script share git history with the template. This enables seamless updates using standard git merge.

The `template-upstream` remote points to your local copy of the template (pull-only, push disabled). When the template is updated, you can merge those changes into your app.

---

## Git Remotes

| Remote | Purpose | Push? |
|--------|---------|-------|
| `template-upstream` | Template repository for updates | No (disabled) |
| `origin` | Your app's repository | Yes |

The create script sets up `template-upstream` automatically. Push is disabled to prevent accidentally pushing your app code back to the template.

---

## Checking for Updates

<Tabs>
  <TabItem label="npm Script">
    ```bash
    npm run template:check
    ```
    This fetches the latest template and shows available commits.
  </TabItem>
  <TabItem label="Manual">
    ```bash
    git fetch template-upstream
    git log HEAD..template-upstream/main --oneline
    ```
  </TabItem>
</Tabs>

If no commits are shown, you're already up to date.

---

## Applying Updates

### Using the Update Script

The easiest way to update is using the built-in script:

```bash
npm run template:update
```

The script will:
1. Check for uncommitted changes (must be clean)
2. Fetch the latest template
3. Show available commits
4. Ask how you want to merge (merge or rebase)
5. Handle the merge automatically
6. Clean up template-only files

### Merge Options

| Option | When to Use |
|--------|-------------|
| **Merge** (recommended) | Creates a merge commit. Preserves all history. Safe. |
| **Rebase** | Replays your commits on top of template. Cleaner history but rewrites commits. |
| **Preview** | Shows what would change without merging. |

### Manual Update

<Steps>
1. **Ensure clean working directory**
   ```bash
   git status
   ```

2. **Fetch latest template**
   ```bash
   git fetch template-upstream
   ```

3. **Merge updates**
   ```bash
   git merge template-upstream/main
   ```

4. **Resolve any conflicts**

5. **Test your app**
   ```bash
   npm run type-check
   npm run dev
   ```
</Steps>

---

## What Gets Updated vs Preserved

### Updated (template infrastructure)

These files come from the template and should generally accept updates:

| Path | Contents |
|------|----------|
| `frontend/src/config/*.ts` | Registry definitions |
| `frontend/src/lib/*.ts` | Utility functions |
| `backend/src/config/*.ts` | Registry definitions |
| `backend/src/lib/*.ts` | Utilities (prisma, errors) |
| `backend/src/middleware/*.ts` | Auth middleware |
| `CLAUDE.md` | AI assistant instructions |
| `update-template.*` | Update scripts |

### Preserved (your code)

These files are yours and won't be touched:

| Path | Contents |
|------|----------|
| `frontend/src/features/*` | Your feature modules |
| `backend/src/features/*` | Your feature modules |
| `.env` files | Your credentials |
| `backend/prisma/schema.prisma` | Your database schema |
| `package.json` | Your app name/version |

### Potential Conflicts

These files exist in both but you may have modified:

| Path | Resolution |
|------|------------|
| `frontend/src/routes.tsx` | Merge carefully - keep your routes |
| `frontend/src/components/layout/*` | Usually accept template changes |
| Root config files | Review changes |

---

## Handling Conflicts

When git can't automatically merge a file, you'll see conflict markers:

```text
<<<<<<< HEAD
// Your version
=======
// Template version
>>>>>>> template-upstream/main
```

### Resolution Commands

```bash
# Keep your version entirely
git checkout --ours path/to/file

# Take template version entirely
git checkout --theirs path/to/file

# After resolving, mark as resolved
git add path/to/file

# Continue with merge
git commit

# Or abort if something went wrong
git merge --abort
```

### Common Conflict Patterns

**routes.tsx** - You added routes, template structure changed:
- Keep your route imports and spreads
- Accept any structural changes to the router setup

**Layout components** - You customised, template updated:
- Usually accept template changes
- Re-apply your customisations after

---

## After Updating

<Steps>
1. **Install any new dependencies**
   ```bash
   npm install
   cd frontend && npm install
   cd ../backend && npm install
   ```

2. **Run database migrations** (if schema changed)
   ```bash
   cd backend && npx prisma migrate dev
   ```

3. **Generate Prisma client**
   ```bash
   cd backend && npx prisma generate
   ```

4. **Test your app**
   ```bash
   npm run dev
   ```

5. **Push to your repository**
   ```bash
   git push
   ```
</Steps>

---

## Troubleshooting

### "Not a git repository"

Run the update script from your app's root folder.

### "You have uncommitted changes"

Commit or stash your changes first:
```bash
git stash
# Run update
git stash pop
```

### "No common ancestor"

This happens on first merge if histories are unrelated. The script handles this with `--allow-unrelated-histories`.

### Template remote missing

If `template-upstream` wasn't set up:
```bash
# Point to your local template copy
git remote add template-upstream ../unique-react-fullstack-starter
git remote set-url --push template-upstream no_push
```

---

## Version Tracking

Both the template and your app have version numbers:

| Location | Purpose |
|----------|---------|
| Template `VERSION` file | Template release version |
| App `package.json` version | Your app's version |

The update script shows both versions when checking for updates.

---

## Technical Details

### How the Update System Works

Apps are created via `git clone` (not copy), which preserves git history. This enables:

- `git fetch template-upstream` to get updates
- `git merge` to intelligently merge changes
- Conflicts only where both sides modified the same file

### Template-Only Files

These files exist in the template but should never exist in apps. The update script automatically removes them during merge:

- `create-app.ps1`, `create-app.sh`, `create-app.bat`
- Template-specific documentation files

When git detects these as "modify/delete" conflicts, the script resolves them automatically by removing them.

### First Merge (Unrelated Histories)

The first merge requires the `--allow-unrelated-histories` flag. The script detects this by checking if `git merge-base` returns an error, then handles it automatically.

### Self-Updating Scripts

The update scripts can update themselves. When this happens:

1. New script version is fetched from template
2. Script commits its own update
3. Script pushes the commit
4. Waits briefly (prevents race conditions)
5. Re-executes with original arguments

This ensures you always run the latest update logic.

### Upstream Tracking

**Important**: The app branch should NOT track `template-upstream`. If it does, VS Code may try to push to it (which fails) and show files as "locked". The scripts run `git branch --unset-upstream` to prevent this.

---

## Next Steps

- [Configuration](/starter-template/configuration/) - Environment setup
- [Project Architecture](/starter-template/architecture/) - File organisation
