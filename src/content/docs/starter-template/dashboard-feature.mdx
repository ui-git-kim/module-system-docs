---
title: Dashboard Feature
description: Dashboard widgets and the widget registry system
---

import { Aside, Steps, Tabs, TabItem } from '@astrojs/starlight/components';

The dashboard feature provides the main application shell and an extensible widget system for the home page.

<Aside type="tip">
  For details on the sidebar, header, navigation, and toolbar, see [Shell Layout](/starter-template/shell-layout/).
</Aside>

---

## Overview

The dashboard feature includes:

- **Application Shell** - Sidebar, header, and content area (see [Shell Layout](/starter-template/shell-layout/))
- **Widget System** - Extensible grid of dashboard widgets
- **Widget Registry** - Features register widgets that appear on the home page
- **User Preferences** - Users can show/hide widgets

---

## File Structure

```
frontend/src/features/dashboard/
├── index.ts                        # Public exports
├── routes.config.tsx               # Dashboard routes
├── navigation.registration.ts      # Registers "Dashboard" in sidebar
├── header-toolbar.registration.ts  # Registers theme toggle
├── dashboard.widgets.ts            # Registers example widgets
├── pages/
│   ├── DashboardPage.tsx           # Main layout (shell)
│   └── DashboardHome.tsx           # Home page with widget grid
├── components/
│   ├── DashboardGrid.tsx           # Widget grid renderer
│   ├── header/                     # Header components
│   ├── sidebar/                    # Sidebar components
│   └── widgets/
│       └── ExampleWidgets.tsx      # Example widget components
```

---

## Dashboard Widgets

Widgets are self-contained components that display on the dashboard home page. They're registered via the `dashboardRegistry` and rendered in a responsive grid.

### Registering Widgets

```tsx
// features/analytics/dashboard.widgets.ts
import { dashboardRegistry } from '@/config/dashboard.registry';
import { AnalyticsWidget } from './components/widgets/AnalyticsWidget';

dashboardRegistry.register({
  id: 'analytics-overview',
  title: 'Analytics Overview',
  description: 'Key metrics at a glance',
  component: AnalyticsWidget,
  size: '2x1',
  order: 20,
  category: 'analytics',
  canHide: true,
  canResize: false,
});
```

### Widget Configuration

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | string | Yes | Unique identifier |
| `title` | string | Yes | Display title (shown in header) |
| `description` | string | No | Tooltip/aria description |
| `component` | ComponentType | Yes | React component to render |
| `size` | WidgetSize | Yes | Grid size (see below) |
| `order` | number | No | Sort order (lower = first). Default: 10 |
| `category` | string | No | Grouping category |
| `canHide` | boolean | No | User can hide widget. Default: true |
| `canResize` | boolean | No | User can resize widget. Default: false |
| `requiredRole` | UserRole | No | Role-based visibility |

### Widget Sizes

Widgets specify their size in grid units (width × height):

| Size | Description | Use Case |
|------|-------------|----------|
| `'1x1'` | Single cell | Quick stats, small indicators |
| `'2x1'` | Double width | Charts, summaries |
| `'1x2'` | Double height | Vertical lists, timelines |
| `'2x2'` | Large square | Detailed charts, tables |
| `'full'` | Full width | Wide tables, activity feeds |

The grid adapts to screen size:

| Breakpoint | Columns | `'2x1'` spans |
|------------|---------|---------------|
| Desktop | 4 columns | 2 columns |
| Tablet | 2 columns | 2 columns (full width) |
| Mobile | 1 column | 1 column (full width) |

### Creating Widget Components

Widget components receive props with their configuration and context:

```tsx
import type { DashboardWidgetProps } from '@/config/dashboard.registry';
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';

export function AnalyticsWidget({ widget, isCompact }: DashboardWidgetProps) {
  return (
    <Card className="h-full">
      <CardHeader className="pb-2">
        <CardTitle className="text-sm font-medium">{widget.title}</CardTitle>
      </CardHeader>
      <CardContent>
        {isCompact ? (
          <CompactStats />
        ) : (
          <FullChart />
        )}
      </CardContent>
    </Card>
  );
}
```

| Prop | Type | Description |
|------|------|-------------|
| `widget` | DashboardWidget | The widget's registration config |
| `isCompact` | boolean | True when widget should show minimal UI |

<Aside type="tip">
  Widgets should be self-contained and handle their own data fetching. Use React Query or SWR for data that needs caching/revalidation.
</Aside>

### Widget Order

The `order` property determines where widgets appear in the grid (lower values appear first):

| Range | Purpose |
|-------|---------|
| 1-9 | Critical/primary widgets (always top) |
| 10 | Default order |
| 11-49 | Important feature widgets |
| 50-99 | Standard feature widgets |
| 100+ | Third-party/plugin widgets |

```tsx
// Low order value - appears first
dashboardRegistry.register({
  id: 'welcome',
  order: 5,
  // ...
});

// Higher order value - appears later
dashboardRegistry.register({
  id: 'tips',
  order: 90,
  // ...
});
```

---

## User Widget Preferences

Users can hide widgets they don't want to see. Preferences are stored in the user's profile.

### Preference Structure

```typescript
// Stored in user.preferences.dashboardWidgets
interface WidgetVisibility {
  id: string;
  visible: boolean;
  order?: number;  // Future: custom ordering
}
```

### Using the Hook

```tsx
import { useVisibleDashboardWidgets } from '@/config/registry.hooks';
import { useUserProfile } from '@/features/user';

function DashboardHome() {
  const { profile } = useUserProfile();
  const visibleWidgets = useVisibleDashboardWidgets(
    profile?.preferences?.dashboardWidgets
  );

  return (
    <DashboardGrid widgets={visibleWidgets} />
  );
}
```

### Widget Visibility UI

To let users manage widget visibility, create a settings component:

```tsx
import { useDashboardRegistry } from '@/config/registry.hooks';
import { useUserProfile } from '@/features/user';
import { SettingsToggleGroup } from '@/features/user/components/settings/SettingsComponents';

function DashboardWidgetSettings() {
  const allWidgets = useDashboardRegistry();
  const { profile, updatePreferences } = useUserProfile();

  const hideableWidgets = allWidgets.filter(w => w.canHide);
  const currentVisibility = profile?.preferences?.dashboardWidgets || [];

  const items = hideableWidgets.map(widget => ({
    id: widget.id,
    label: widget.title,
    description: widget.description,
    checked: isVisible(widget.id, currentVisibility),
  }));

  const handleToggle = (id: string, visible: boolean) => {
    const updated = updateVisibility(currentVisibility, id, visible);
    updatePreferences({ dashboardWidgets: updated });
  };

  return (
    <SettingsToggleGroup items={items} onChange={handleToggle} />
  );
}
```

---

## DashboardGrid Component

The `DashboardGrid` component renders widgets in a responsive CSS grid. It handles widget visibility, sizing, and provides an empty state.

### Basic Usage

```tsx
import { DashboardGrid } from '@/features/dashboard/components/DashboardGrid';
import { useUserProfile } from '@/features/user';

function DashboardHome() {
  const { profile } = useUserProfile();

  return (
    <div className="space-y-6">
      <h1>Dashboard</h1>
      <DashboardGrid userVisibility={profile?.preferences?.dashboardWidgets} />
    </div>
  );
}
```

### Props

| Prop | Type | Description |
|------|------|-------------|
| `userVisibility` | `UserWidgetPreference[]` | User's widget visibility preferences |
| `className` | `string` | Additional classes for the grid container |

### Grid Constants

The dashboard provides pre-defined CSS classes for consistent grid layouts:

```tsx
import {
  WIDGET_SIZE_CLASSES,
  DASHBOARD_GRID_CLASSES,
} from '@/config/dashboard.registry';

// Container: 4 columns desktop, 2 tablet, 1 mobile
// 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 auto-rows-min'
<div className={DASHBOARD_GRID_CLASSES}>

// Individual widget size classes
<div className={WIDGET_SIZE_CLASSES[widget.size]}>
```

### Size to Grid Classes

| Size | Grid Classes |
|------|--------------|
| `'1x1'` | `col-span-1 row-span-1` |
| `'2x1'` | `col-span-2 row-span-1` |
| `'1x2'` | `col-span-1 row-span-2` |
| `'2x2'` | `col-span-2 row-span-2` |
| `'full'` | `col-span-full row-span-1` |

### Empty State

When no widgets are visible, `DashboardGrid` shows a dashed border placeholder with a helpful message.

### RawWidgetWrapper

For widgets that need custom styling without the default Card wrapper:

```tsx
import { RawWidgetWrapper } from '@/features/dashboard/components/DashboardGrid';

<RawWidgetWrapper widget={widget} className="my-custom-class" />
```

### Utility Functions

The registry provides a type guard for validating widget sizes at runtime:

```tsx
import { isValidWidgetSize } from '@/config/dashboard.registry';

if (isValidWidgetSize(userProvidedSize)) {
  // userProvidedSize is now typed as WidgetSize
}
```

---

## Registry Hooks

### Get All Widgets

```tsx
import { useDashboardRegistry } from '@/config/registry.hooks';

function MyComponent() {
  const allWidgets = useDashboardRegistry();
  // Returns all registered widgets, sorted by order value
}
```

### Get Visible Widgets

```tsx
import { useVisibleDashboardWidgets } from '@/config/registry.hooks';

function DashboardHome() {
  const visibleWidgets = useVisibleDashboardWidgets(userPreferences);
  // Returns widgets filtered by user visibility preferences
}
```

### Get Widgets by Category

```tsx
import { dashboardRegistry } from '@/config/dashboard.registry';

const analyticsWidgets = dashboardRegistry
  .getAll()
  .filter(w => w.category === 'analytics');
```

---

## Example Widgets

The template includes example widgets to demonstrate the pattern:

```tsx
// features/dashboard/components/widgets/ExampleWidgets.tsx

export function WelcomeWidget({ widget }: DashboardWidgetProps) {
  const { profile } = useUserProfile();

  return (
    <Card>
      <CardHeader>
        <CardTitle>Welcome back, {profile?.name || 'there'}!</CardTitle>
      </CardHeader>
      <CardContent>
        <p className="text-muted-foreground">
          Here's what's happening today.
        </p>
      </CardContent>
    </Card>
  );
}

export function QuickStatsWidget({ widget }: DashboardWidgetProps) {
  return (
    <Card>
      <CardHeader className="pb-2">
        <CardTitle className="text-sm">{widget.title}</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="text-2xl font-bold">1,234</div>
        <p className="text-xs text-muted-foreground">+12% from last month</p>
      </CardContent>
    </Card>
  );
}
```

---

## Best Practices

### Widget Design

1. **Self-contained** - Widgets fetch their own data
2. **Responsive** - Handle different sizes gracefully
3. **Loading states** - Show skeletons while loading
4. **Error handling** - Display errors gracefully, don't break the grid
5. **Compact mode** - Support `isCompact` prop for constrained displays

### Registration

1. **Unique IDs** - Use feature-prefixed IDs (e.g., `analytics-overview`)
2. **Sensible order values** - Use the order ranges consistently
3. **Allow hiding** - Set `canHide: true` unless the widget is essential
4. **Categories** - Group related widgets for potential filtering

### Performance

1. **Lazy loading** - Consider `React.lazy()` for heavy widgets
2. **Data caching** - Use React Query/SWR for API data
3. **Memoization** - Memoize expensive calculations

---

## Troubleshooting

### Widget Not Appearing

1. Verify registration file is imported in feature's `index.ts`
2. Check feature's `index.ts` is imported in app entry point
3. Confirm user hasn't hidden it in preferences
4. Check `requiredRole` matches current user's role

### Widget Wrong Size

1. Verify `size` property matches expected format (`'2x1'`, not `'2x'`)
2. Check grid container has correct column setup
3. Inspect CSS classes being applied

### Widget Data Not Loading

1. Check widget component handles loading/error states
2. Verify API endpoints are correct
3. Check authentication token is being sent

---

## Next Steps

- [Shell Layout](/starter-template/shell-layout/) - Sidebar, header, navigation details
- [Registry Reference](/starter-template/registries/) - Full registry API
- [User Feature](/starter-template/user-feature/) - Widget preferences storage
