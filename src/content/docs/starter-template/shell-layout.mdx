---
title: Shell Layout
description: Understanding the dashboard shell - sidebar, header, and user menu
---

import { Aside, Steps, Tabs, TabItem } from '@astrojs/starlight/components';

The starter template uses [shadcn/ui's sidebar component](https://ui.shadcn.com/docs/components/sidebar) to create the application shell. This provides a consistent, accessible layout with a collapsible sidebar, header with breadcrumbs, and extensible toolbar.

---

## Overview

The dashboard shell consists of three main areas:

```
┌─────────────────────────────────────────────────────────────┐
│                        Header                               │
│  [☰] [Breadcrumbs]          [Center Items]    [Right Items] │
├────────────┬────────────────────────────────────────────────┤
│            │                                                │
│  Sidebar   │                 Main Content                   │
│            │                                                │
│ ┌────────┐ │                                                │
│ │ Logo   │ │                                                │
│ ├────────┤ │                                                │
│ │ Main   │ │                                                │
│ │ Nav    │ │                                                │
│ ├────────┤ │                                                │
│ │Secondry│ │                                                │
│ ├────────┤ │                                                │
│ │ User   │ │                                                │
│ └────────┘ │                                                │
└────────────┴────────────────────────────────────────────────┘
```

The layout is assembled in `DashboardPage.tsx`:

```tsx
function DashboardPage() {
  return (
    <AppSettingsProvider>      {/* Global app settings */}
      <UserProfileProvider>     {/* User profile data */}
        <SidebarProvider         {/* shadcn sidebar state */}
          style={{
            '--sidebar-width': '16rem',
            '--header-height': '3rem',
          }}
        >
          <AppSidebar variant="inset" />
          <SidebarInset>
            <SiteHeader />
            <main className="@container/main flex-1 p-4 md:p-6">
              <Outlet />        {/* Page content */}
            </main>
          </SidebarInset>
        </SidebarProvider>
      </UserProfileProvider>
    </AppSettingsProvider>
  );
}
```

---

## Sidebar

The sidebar uses shadcn/ui's `Sidebar` component with the **inset** variant and **icon** collapsible mode.

### Sidebar Variants

The template uses two key shadcn sidebar features:

| Feature | Value | Description |
|---------|-------|-------------|
| `variant` | `"inset"` | Sidebar is inset from the page edges with a background panel |
| `collapsible` | `"icon"` | Collapses to icon-only mode (no full hide) |

```tsx
<AppSidebar variant="inset" />

// Inside AppSidebar.tsx:
<Sidebar collapsible="icon" {...props}>
```

When collapsed, the sidebar shows only icons with tooltips on hover.

### Sidebar Structure

The `AppSidebar` component is built from shadcn primitives:

```tsx
<Sidebar collapsible="icon">
  <SidebarHeader>         {/* Logo + App Name */}
    <SidebarMenu>
      <SidebarMenuItem>
        <SidebarMenuButton size="lg">
          {/* Logo + App name (from admin settings) */}
        </SidebarMenuButton>
      </SidebarMenuItem>
    </SidebarMenu>
  </SidebarHeader>

  <SidebarContent>        {/* Navigation sections */}
    <NavMain items={mainItems} />
    <NavSecondary items={secondaryItems} className="mt-auto" />
  </SidebarContent>

  <SidebarFooter>         {/* User menu */}
    <NavUser />
  </SidebarFooter>

  <SidebarRail />         {/* Collapse/expand rail */}
</Sidebar>
```

### Components Used

| Component | shadcn Import | Purpose |
|-----------|--------------|---------|
| `Sidebar` | `@/components/ui/sidebar` | Main sidebar container |
| `SidebarHeader` | `@/components/ui/sidebar` | Top section (logo) |
| `SidebarContent` | `@/components/ui/sidebar` | Scrollable navigation area |
| `SidebarFooter` | `@/components/ui/sidebar` | Bottom section (user menu) |
| `SidebarRail` | `@/components/ui/sidebar` | Clickable edge for collapse |
| `SidebarMenu` | `@/components/ui/sidebar` | Menu container |
| `SidebarMenuItem` | `@/components/ui/sidebar` | Individual menu item wrapper |
| `SidebarMenuButton` | `@/components/ui/sidebar` | Clickable menu button with tooltip support |
| `SidebarGroup` | `@/components/ui/sidebar` | Group with optional label |
| `SidebarGroupLabel` | `@/components/ui/sidebar` | Section header (e.g., "Application") |

### CSS Variables

The sidebar width and header height are controlled via CSS custom properties:

```tsx
<SidebarProvider
  style={{
    '--sidebar-width': '16rem',    // 256px expanded
    '--header-height': '3rem',     // 48px
  }}
>
```

<Aside type="tip">
  When the sidebar collapses to icon mode, it uses `--sidebar-width-icon` (default ~48px).
</Aside>

---

## Main Navigation

Main navigation items appear in the primary scrollable section of the sidebar.

### Structure

```tsx
// NavMain.tsx
<SidebarGroup>
  <SidebarGroupLabel>Application</SidebarGroupLabel>
  <SidebarMenu>
    {items.map(item => (
      <SidebarMenuItem key={item.title}>
        <SidebarMenuButton asChild tooltip={item.title} isActive={isActive}>
          <Link to={item.url}>
            <item.icon />
            <span>{item.title}</span>
          </Link>
        </SidebarMenuButton>
      </SidebarMenuItem>
    ))}
  </SidebarMenu>
</SidebarGroup>
```

### Features

- **Active State**: Automatically highlights based on current route (`location.pathname.startsWith(item.url)`)
- **Tooltips**: Shows item title when sidebar is collapsed
- **Role-Based Visibility**: Items with `requiredRole` are filtered based on user's role
- **Collapsible Sub-Items**: Supports nested navigation with `Collapsible` component

### Collapsible Sub-Navigation

Items with nested children use shadcn's `Collapsible`:

```tsx
<Collapsible asChild defaultOpen={isActive}>
  <SidebarMenuItem>
    <CollapsibleTrigger asChild>
      <SidebarMenuButton tooltip={item.title}>
        <item.icon />
        <span>{item.title}</span>
        <ChevronRight className="ml-auto transition-transform
          group-data-[state=open]/collapsible:rotate-90" />
      </SidebarMenuButton>
    </CollapsibleTrigger>
    <CollapsibleContent>
      <SidebarMenuSub>
        {item.items.map(subItem => (
          <SidebarMenuSubItem key={subItem.title}>
            <SidebarMenuSubButton asChild isActive={...}>
              <Link to={subItem.url}>{subItem.title}</Link>
            </SidebarMenuSubButton>
          </SidebarMenuSubItem>
        ))}
      </SidebarMenuSub>
    </CollapsibleContent>
  </SidebarMenuItem>
</Collapsible>
```

### Registering Navigation Items

Features register navigation via the `navigationRegistry`:

```tsx
// features/projects/navigation.registration.ts
import { navigationRegistry } from '@/config/navigation.registry';
import { Folder } from 'lucide-react';

navigationRegistry.registerMain({
  id: 'projects',
  title: 'Projects',
  url: '/projects',
  icon: Folder,
  order: 20,
});
```

See [Navigation Registry](/starter-template/registries/#navigation-registry) for full documentation.

---

## Secondary Navigation

Secondary navigation appears at the bottom of the sidebar content (above the user menu). Typically used for Settings, Support, Admin links.

### Structure

```tsx
// NavSecondary.tsx
<SidebarGroup className="mt-auto">  {/* mt-auto pushes to bottom */}
  <SidebarGroupContent>
    <SidebarMenu>
      {items.map(item => (
        <SidebarMenuItem key={item.title}>
          <SidebarMenuButton asChild tooltip={item.title} isActive={...}>
            <Link to={item.url}>
              <item.icon />
              <span>{item.title}</span>
            </Link>
          </SidebarMenuButton>
        </SidebarMenuItem>
      ))}
    </SidebarMenu>
  </SidebarGroupContent>
</SidebarGroup>
```

### Built-in Secondary Items

| Item | Route | Description |
|------|-------|-------------|
| Support | `/support` | Help and support page |
| Admin | `/admin` | Admin panel (admin role only) |

### Registering Secondary Items

```tsx
navigationRegistry.registerSecondary({
  id: 'help',
  title: 'Help',
  url: '/help',
  icon: HelpCircle,
  order: 10,
});
```

---

## User Menu

The user menu appears in the sidebar footer and provides quick access to user-related actions.

### Structure

```tsx
// NavUser.tsx
<SidebarMenu>
  <SidebarMenuItem>
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <SidebarMenuButton size="lg">
          <UserAvatar size="md" rounded="lg" />
          <div className="grid flex-1 text-left text-sm">
            <span className="truncate font-medium">{displayName}</span>
            <span className="text-muted-foreground truncate text-xs">{email}</span>
          </div>
          <MoreVertical className="ml-auto size-4" />
        </SidebarMenuButton>
      </DropdownMenuTrigger>

      <DropdownMenuContent side={isMobile ? 'bottom' : 'right'}>
        {/* User info header */}
        <DropdownMenuLabel>
          <UserAvatar /> {displayName}
        </DropdownMenuLabel>
        <DropdownMenuSeparator />

        {/* Registered menu items */}
        <DropdownMenuGroup>
          {userMenuItems.map((item) => (
            <DropdownMenuItem key={item.id}>
              <item.icon className="mr-2 h-4 w-4" />
              {item.title}
            </DropdownMenuItem>
          ))}
        </DropdownMenuGroup>

        <DropdownMenuSeparator />
        <DropdownMenuItem onClick={handleLogout}>
          <LogOut className="mr-2 h-4 w-4" />
          Sign out
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  </SidebarMenuItem>
</SidebarMenu>
```

### Features

- **User Avatar**: Shows profile image or initials fallback
- **Display Name**: User's name or email username
- **Email**: Full email address
- **Extensible**: Features can register additional menu items
- **Sign Out**: Always present at the bottom

### Registering User Menu Items

```tsx
navigationRegistry.registerUserMenu({
  id: 'account',
  title: 'Account',
  url: '/settings/account',
  icon: User,
  order: 10,
});

// Action-only item (no URL)
navigationRegistry.registerUserMenu({
  id: 'keyboard-shortcuts',
  title: 'Keyboard Shortcuts',
  icon: Keyboard,
  order: 20,
  onClick: () => openShortcutsModal(),
});
```

---

## Header

The site header provides breadcrumb navigation and an extensible toolbar.

### Structure

```tsx
// SiteHeader.tsx
<header className="flex h-(--header-height) items-center border-b">
  <div className="flex w-full items-center px-4 lg:px-6">
    {/* Left: Sidebar trigger + Breadcrumbs */}
    <div className="flex items-center gap-2">
      <SidebarTrigger className="-ml-1" />
      <Separator orientation="vertical" className="h-4" />
      <Breadcrumb>
        {/* Breadcrumb items */}
      </Breadcrumb>
    </div>

    {/* Toolbar (handles center and right positioning) */}
    <HeaderToolbar />
  </div>
</header>
```

### Sidebar Trigger

The hamburger menu button that toggles sidebar collapse:

```tsx
import { SidebarTrigger } from '@/components/ui/sidebar';

<SidebarTrigger className="-ml-1" />
```

This is automatically connected to `SidebarProvider` context.

---

## Breadcrumbs

Breadcrumbs are automatically generated from route handles.

### How It Works

Routes define breadcrumb labels via the `handle` property:

```tsx
// routes.config.tsx
{
  path: 'settings',
  element: <SettingsLayout />,
  handle: { crumb: 'Settings' },  // Breadcrumb label
  children: [
    {
      path: 'profile',
      element: <ProfilePage />,
      handle: { crumb: 'Profile' },
    },
  ],
}
```

The header reads all matched routes and builds the breadcrumb trail:

```tsx
// SiteHeader.tsx
const matches = useMatches();

const crumbs = matches
  .filter((match) => match.handle?.crumb)
  .map((match) => ({
    path: match.pathname,
    label: match.handle.crumb,
  }));
```

### Rendering

- **Multiple crumbs**: Shows full trail with separators
- **Single crumb**: Shows just the current page name
- **No crumbs**: Falls back to "Dashboard"
- **Responsive**: Hides intermediate crumbs on mobile

```tsx
<Breadcrumb>
  <BreadcrumbList>
    {crumbs.map((crumb, index) => {
      const isLast = index === crumbs.length - 1;
      return (
        <BreadcrumbItem className={!isLast ? 'hidden md:block' : ''}>
          {isLast ? (
            <BreadcrumbPage>{crumb.label}</BreadcrumbPage>
          ) : (
            <BreadcrumbLink asChild>
              <Link to={crumb.path}>{crumb.label}</Link>
            </BreadcrumbLink>
          )}
        </BreadcrumbItem>
      );
    })}
  </BreadcrumbList>
</Breadcrumb>
```

---

## Header Toolbar

The toolbar provides extensible action buttons in the header.

### Positions

Items can be positioned in two areas:

| Position | Location | Typical Use |
|----------|----------|-------------|
| `left` | Center of header (between breadcrumbs and right items) | Search, primary actions |
| `right` | Far right of header | Theme toggle, notifications, settings |

### Layout

```tsx
// HeaderToolbar.tsx
<TooltipProvider>
  <div className="flex-1" />           {/* Spacer */}

  {/* Center items */}
  <div className="flex items-center gap-1">
    {leftItems.map(item => <HeaderToolbarItem key={item.id} item={item} />)}
  </div>

  <div className="flex-1" />           {/* Spacer */}

  {/* Right items */}
  <div className="flex items-center gap-1">
    {rightItems.map(item => <HeaderToolbarItem key={item.id} item={item} />)}
  </div>
</TooltipProvider>
```

### Item Types

| Type | Description | Example |
|------|-------------|---------|
| `action` | Simple button that triggers onClick | Search button |
| `toggle` | Button with active state | Theme toggle |
| `dropdown` | Button that opens dropdown menu | Notifications |
| `custom` | Fully custom component | User avatar |

### Registering Toolbar Items

```tsx
// features/search/toolbar.registration.ts
import { headerToolbarRegistry } from '@/config/header-toolbar.registry';
import { Search } from 'lucide-react';

headerToolbarRegistry.register({
  id: 'global-search',
  type: 'action',
  position: 'left',
  order: 10,
  icon: Search,
  label: 'Search (Cmd+K)',
  onClick: () => openSearchModal(),
});
```

### Built-in Toolbar Items

The template registers a theme toggle by default:

```tsx
// dashboard/toolbar.registration.ts
headerToolbarRegistry.register({
  id: 'theme-toggle',
  type: 'custom',
  position: 'right',
  order: 100,
  component: ThemeToggle,
  label: 'Toggle theme',
});
```

See [Header Toolbar Registry](/starter-template/registries/#header-toolbar-registry) for full documentation.

---

## Admin Overrides

Admins can customise the shell without code changes:

| What | Where | Effect |
|------|-------|--------|
| **Hide navigation items** | Admin → Navigation | Items hidden from sidebar |
| **Reorder navigation** | Admin → Navigation | Drag-and-drop to reorder |
| **Hide toolbar items** | Admin → Header Toolbar | Items hidden from header |
| **App branding** | Admin → App Settings | Logo, name, display mode |
| **Section label** | Admin → App Settings | Show/hide and customise the "Application" heading |
| **Dashboard in nav** | Admin → App Settings | Show/hide Dashboard item in main nav |

These overrides are applied in `AppSidebar` and `HeaderToolbar` via the `useAppSettingsValue()` hook.

```tsx
// AppSidebar.tsx
const settings = useAppSettingsValue();

// Pass section label settings to NavMain
<NavMain
  items={filteredMainItems}
  showSectionLabel={settings.showMainSectionLabel}
  sectionLabel={settings.mainSectionLabel}
/>
```

### Section Label

The "Application" heading above the main navigation can be:

- **Hidden entirely** - Toggle off "Show section label" in Admin → App Settings
- **Customised** - Change the label text (e.g., "Menu", "Navigation", your app name)

```tsx
// NavMain receives these props from AppSidebar
interface NavMainProps {
  items: NavigationItem[];
  showSectionLabel?: boolean;  // Default: true
  sectionLabel?: string;       // Default: "Application"
}
```

See [Admin Feature](/starter-template/admin-feature/) for full documentation.

---

## Layout Utilities

The template provides layout utilities that modules can use for special page layouts.

### FullBleed

Removes the default dashboard padding for pages that need to fill the entire content area. Ideal for builders, editors, maps, or canvas-style interfaces.

```tsx
import { FullBleed } from '@/components/layout';

export function BlockBuilderPage() {
  return (
    <FullBleed collapseSidebar>
      <div className="h-full flex">
        <ToolsSidebar />
        <Canvas />
        <PropertiesPanel />
      </div>
    </FullBleed>
  );
}
```

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `ReactNode` | - | Content to render |
| `className` | `string` | - | Additional classes |
| `collapseSidebar` | `boolean` | `false` | Auto-collapse sidebar to icon mode on mount |

**How it works:** Uses negative margins to counteract the parent `p-4 md:p-6` padding, then recalculates width/height to fill the space.

```tsx
// Internal implementation
<div className={cn(
  '-m-4 md:-m-6',                              // Counteract padding
  'w-[calc(100%+2rem)] md:w-[calc(100%+3rem)]', // Restore width
  'h-[calc(100%+2rem)] md:h-[calc(100%+3rem)]', // Restore height
  'min-h-full',
  className
)}>
  {children}
</div>
```

### Collapsible Sections

For collapsible content sections within pages, use shadcn's `Collapsible` component:

```tsx
import {
  Collapsible,
  CollapsibleContent,
  CollapsibleTrigger,
} from '@/components/ui/collapsible';
import { ChevronRight } from 'lucide-react';

function CollapsibleSection({ title, children }) {
  return (
    <Collapsible defaultOpen>
      <CollapsibleTrigger className="flex items-center gap-2">
        <ChevronRight className="h-4 w-4 transition-transform
          group-data-[state=open]:rotate-90" />
        <span>{title}</span>
      </CollapsibleTrigger>
      <CollapsibleContent>
        {children}
      </CollapsibleContent>
    </Collapsible>
  );
}
```

This is the same component used for nested navigation items in the sidebar.

### Programmatic Sidebar Control

Access sidebar state from any component within the shell:

```tsx
import { useSidebar } from '@/components/ui/sidebar';

function MyComponent() {
  const {
    open,           // Is sidebar expanded?
    setOpen,        // Set sidebar state
    isMobile,       // Is mobile viewport?
    openMobile,     // Mobile sidebar open state
    setOpenMobile,  // Set mobile sidebar state
  } = useSidebar();

  // Collapse sidebar
  const handleCollapse = () => setOpen(false);

  // Expand sidebar
  const handleExpand = () => setOpen(true);

  return (
    <Button onClick={() => setOpen(!open)}>
      {open ? 'Collapse' : 'Expand'} Sidebar
    </Button>
  );
}
```

<Aside type="tip">
  The `FullBleed` component uses `useSidebar` internally to implement `collapseSidebar`.
</Aside>

---

## File Structure

```
frontend/src/features/dashboard/
├── pages/
│   └── DashboardPage.tsx         # Shell layout assembly
├── components/
│   ├── sidebar/
│   │   ├── AppSidebar.tsx        # Main sidebar component
│   │   ├── NavMain.tsx           # Main navigation section
│   │   ├── NavSecondary.tsx      # Secondary navigation section
│   │   └── NavUser.tsx           # User menu (footer)
│   └── header/
│       ├── SiteHeader.tsx        # Header with breadcrumbs
│       ├── HeaderToolbar.tsx     # Toolbar container
│       ├── HeaderToolbarItem.tsx # Individual toolbar item renderer
│       └── ThemeToggle.tsx       # Theme toggle component
└── ...
```

---

## Customisation

### Changing Sidebar Width

Modify the CSS variable in `DashboardPage.tsx`:

```tsx
<SidebarProvider
  style={{
    '--sidebar-width': '18rem',  // Wider sidebar
    '--header-height': '4rem',   // Taller header
  }}
>
```

### Changing the Logo

1. **Via Admin Panel**: Admin → App Settings → Upload logo
2. **Default Logo**: Modify `DefaultLogo` component in `AppSidebar.tsx`

### Adding Sidebar Sections

Create a new nav component and add it to `AppSidebar`:

```tsx
// AppSidebar.tsx
<SidebarContent>
  <NavMain items={mainItems} />
  <NavProjects />                   {/* New section */}
  <NavSecondary items={secondaryItems} className="mt-auto" />
</SidebarContent>
```

### Custom Breadcrumb Logic

Override the breadcrumb rendering in `SiteHeader.tsx` or create a custom breadcrumb component.

---

## Next Steps

- [Navigation Registry](/starter-template/registries/#navigation-registry) - Register sidebar items
- [Header Toolbar Registry](/starter-template/registries/#header-toolbar-registry) - Register toolbar items
- [Admin Feature](/starter-template/admin-feature/) - Manage navigation overrides
- [Dashboard Feature](/starter-template/dashboard-feature/) - Dashboard widgets
