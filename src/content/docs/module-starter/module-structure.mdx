---
title: Module Structure
description: File structure reference for module packages and generated output
---

import { FileTree, Aside, Tabs, TabItem } from '@astrojs/starlight/components';

This page documents two structures: the **module package** (what you edit) and the **generated output** (what gets installed into apps).

---

## Module Package Structure

This is what the module starter looks like after cloning:

<FileTree>
- my-module/
  - src/
    - module.ts *(EDIT - module configuration)*
    - cli.ts *(DO NOT EDIT)*
    - index.ts *(exports)*
    - scaffold/ *(DO NOT EDIT - shared infrastructure)*
      - init.ts *(installation pipeline)*
      - update.ts *(hash-based change detection)*
      - uninstall.ts *(manifest-based cleanup)*
      - enable.ts *(re-enable disabled modules)*
      - disable.ts *(disable without removing)*
      - update-schema.ts *(Prisma schema sync)*
      - lifecycle-utils.ts *(lifecycle hook infrastructure)*
      - types.ts *(TypeScript interfaces)*
      - utils.ts *(shared utilities)*
      - index.ts *(public exports)*
    - templates/ *(EDIT - your file templates)*
      - schema.ts
      - frontend/
        - index.ts
        - routes.ts
        - pages.ts
        - components.ts
        - registrations.ts
        - services.ts
        - types.ts
      - backend/
        - index.ts
        - routes.ts
        - services.ts
        - registrations.ts
        - types.ts
  - scripts/ *(version bump scripts)*
  - dist/ *(built output)*
  - package.json
  - VERSION *(scaffold version)*
  - CLAUDE.md *(AI instructions)*
  - README.md
</FileTree>

### Key Files

| File | Purpose | Edit? |
|------|---------|-------|
| `src/module.ts` | Module ID, name, templates, configuration | ✅ Yes |
| `src/templates/**/*.ts` | File content templates | ✅ Yes |
| `src/cli.ts` | CLI command handling | ❌ No |
| `src/scaffold/**/*.ts` | Scaffolding infrastructure | ❌ No |
| `package.json` | Package name, version, bin command | ✅ Yes |
| `VERSION` | Scaffold infrastructure version | Auto |

---

## Generated Output Structure

When users run `npx my-module init`, this structure is created in the target app:

<Tabs>
  <TabItem label="Frontend">
    <FileTree>
    - frontend/src/features/[module]/
      - index.ts *(barrel exports + registration imports)*
      - navigation.registration.ts
      - routes.config.tsx
      - pages/
        - [Module]Page.tsx
      - components/
        - widgets/ *(optional)*
        - settings/ *(optional)*
      - hooks/ *(optional)*
      - services/ *(optional)*
      - types/ *(optional)*
      - registrations/ *(optional)*
        - dashboard.registration.ts
        - preferences.registration.ts
        - ...
    </FileTree>
  </TabItem>
  <TabItem label="Backend">
    <FileTree>
    - backend/src/features/[module]/
      - index.ts *(barrel exports + registration imports)*
      - [module].routes.ts
      - [module].service.ts
      - [module].types.ts
      - route.registration.ts
      - service.registration.ts
    </FileTree>
  </TabItem>
  <TabItem label="Database">
    <FileTree>
    - backend/prisma/
      - schema/ *(multi-file mode)*
        - [module].prisma
      - schema.prisma *(single-file mode - appended)*
    </FileTree>
  </TabItem>
</Tabs>

---

## Naming Conventions

### File Names

| Type | Convention | Example |
|------|------------|---------|
| Module folder | kebab-case | `ai-chat` |
| Routes file | `[module].routes.ts` | `ai-chat.routes.ts` |
| Service file | `[module].service.ts` | `ai-chat.service.ts` |
| Types file | `[module].types.ts` | `ai-chat.types.ts` |
| Page component | `[Module]Page.tsx` | `AiChatPage.tsx` |
| Registration files | `*.registration.ts` | `navigation.registration.ts` |

### Export Names

| Type | Convention | Example |
|------|------------|---------|
| Routes array | `[module]Routes` | `aiChatRoutes` |
| Service object | `[module]Service` | `aiChatService` |
| Main hook | `use[Module]` | `useAiChat` |
| Page component | `[Module]Page` | `AiChatPage` |
| Widget component | `[Module]Widget` | `AiChatWidget` |

---

## Index File Patterns

### Frontend Index

```typescript
// frontend/src/features/[module]/index.ts

// ========================================================================
// REGISTRATION IMPORTS (side effects)
// These MUST come first - they register with app registries
// ========================================================================

import './navigation.registration';
// import './registrations/dashboard.registration';
// import './registrations/preferences.registration';
// import './filter.registration';
// import './action.registration';

// ========================================================================
// PUBLIC EXPORTS
// ========================================================================

export { moduleRoutes } from './routes.config';
export { ModulePage } from './pages/ModulePage';
// export { useModule } from './hooks/useModule';
// export type { ModuleItem } from './types';
```

### Backend Index

```typescript
// backend/src/features/[module]/index.ts

// ========================================================================
// REGISTRATION IMPORTS (side effects)
// ========================================================================

import './route.registration.js';
import './service.registration.js';
// import './filter.registration.js';
// import './action.registration.js';

// ========================================================================
// PUBLIC EXPORTS
// ========================================================================

export { moduleRoutes } from './[module].routes.js';
export { moduleService } from './[module].service.js';
export type * from './[module].types.js';
```

<Aside type="caution">
Backend imports **must** use `.js` extension for relative imports. This is required for ESM compatibility.
</Aside>

---

## Order Convention

All registries use a **0-100 scale** for ordering (lower = appears first):

| Range | Use For | Examples |
|-------|---------|----------|
| **0-25** | Primary features | Dashboard (10), Home (15) |
| **26-50** | Core features | Projects (30), Documents (40) |
| **51-75** | Secondary features | Settings (60), Reports (65) |
| **76-100** | Utilities | Help (80), Admin (90) |

The default order is `50` if not specified. Admins can override order via the admin panel.

<Aside type="tip">
Use `50` for most modules. This puts your feature in the middle, leaving room for admins to reorder. Pick from the ranges above if you want a sensible default position.
</Aside>

---

## Registration Files

Modules use registration files to add themselves to the app's registries. For the complete list of available registries with examples, see [Registry Integration](/module-starter/registry-integration/). For the full API reference, see the starter template's [Registry Reference](/starter-template/registries/).

### Navigation Registration

```typescript
// navigation.registration.ts
import { navigationRegistry } from '@/config/navigation.registry';
import { MessageSquare, FileText } from 'lucide-react';

// Optional: Register a sidebar section to group your items
navigationRegistry.registerSection({
  id: 'ai-tools',
  label: 'AI Tools',
  showLabel: true,
  order: 40,
});

// Main sidebar item
navigationRegistry.registerMain({
  id: 'ai-chat',
  title: 'AI Chat',
  url: '/dashboard/ai-chat',
  icon: MessageSquare,
  order: 50,
  sidebarSection: 'ai-tools',  // Optional: assign to a section
});
```

<Aside type="tip">
The navigation registry supports three areas: `registerMain()` (main sidebar), `registerSecondary()` (bottom sidebar), and `registerUserMenu()` (user dropdown). See [Registry Reference](/starter-template/registries/) for details.
</Aside>

### Route Registration (Backend)

```typescript
// route.registration.ts
import { routeRegistry } from '../../config/route.registry.js';
import { aiChatRoutes } from './ai-chat.routes.js';

routeRegistry.register({
  path: '/ai-chat',
  router: aiChatRoutes,
  feature: 'ai-chat',
  versions: ['v1'],        // Mounted at /api/v1/ai-chat
  requiresAuth: true,
  description: 'AI Chat management',
});
```

### Service Registration (Backend)

```typescript
// service.registration.ts
import { serviceRegistry } from '../../config/service.registry.js';
import { aiChatService } from './ai-chat.service.js';

// Type augmentation for type-safe access
declare module '../../config/service.registry.js' {
  interface ServiceTypes {
    'ai-chat': typeof aiChatService;
  }
}

serviceRegistry.register('ai-chat', aiChatService, {
  feature: 'ai-chat',
  description: 'AI chat business logic',
});
```

<Aside type="note">
For plugins or runtime registration, use `serviceRegistry.registerDynamic()` instead. See [Registry Reference — Service Registry](/starter-template/registries/#service-registry) for details.
</Aside>

---

## Template Organisation

### Split by Category

Templates are organised by file type for maintainability. These are the default files — add more as your module grows (e.g., `hooks.ts`, `dialogs.ts`, `utils.ts`):

```
src/templates/
├── frontend/
│   ├── index.ts        # Re-exports all frontend templates
│   ├── routes.ts       # INDEX_TEMPLATE, ROUTES_CONFIG
│   ├── pages.ts        # PAGE_TEMPLATE, SETTINGS_PAGE_TEMPLATE
│   ├── components.ts   # WIDGET_TEMPLATE, etc.
│   ├── registrations.ts # All *_REGISTRATION templates
│   ├── services.ts     # SERVICE_TEMPLATE
│   ├── types.ts        # TYPES_TEMPLATE
│   └── hooks.ts        # (custom) Hook templates
├── backend/
│   ├── index.ts        # Re-exports all backend templates
│   ├── routes.ts       # INDEX_TEMPLATE, ROUTES_TEMPLATE
│   ├── services.ts     # SERVICE_TEMPLATE
│   ├── registrations.ts # ROUTE_REGISTRATION, SERVICE_REGISTRATION
│   ├── types.ts        # TYPES_TEMPLATE
│   └── middleware.ts   # (custom) Middleware templates
└── schema.ts           # SCHEMA_TEMPLATE
```

<Aside type="tip">
The files above are starting points. Bigger modules often add custom template files for hooks, dialogs, context providers, utilities, middleware, and more. See [Creating Modules — Adding Custom Template Files](/module-starter/creating-modules/#adding-custom-template-files) for how to add your own.
</Aside>

### Template Naming

| Constant | Purpose |
|----------|---------|
| `INDEX_TEMPLATE` | Barrel file (index.ts) |
| `ROUTES_CONFIG` | React Router routes |
| `PAGE_TEMPLATE` | Main page component |
| `ROUTES_TEMPLATE` | Express router |
| `SERVICE_TEMPLATE` | Business logic |
| `*_REGISTRATION` | Registry registration files |
| `SCHEMA_TEMPLATE` | Prisma models |

---

## Next Steps

- [Registry Integration](/module-starter/registry-integration/) - All available registries and how to use them
- [Scaffold Architecture](/module-starter/scaffold/) - How the scaffold infrastructure works
- [Code Templates](/module-starter/templates/) - Copy-paste templates
- [Lifecycle Hooks](/module-starter/lifecycle-hooks/) - Filters, actions, and module lifecycle
- [Creating Modules](/module-starter/creating-modules/) - Step-by-step guide
