---
title: Creating Modules
description: Step-by-step guide to creating a new module package
---

import { Steps, Tabs, TabItem, Aside, FileTree } from '@astrojs/starlight/components';

This guide walks through creating a new module from the module starter template.

---

## Quick Start

<Steps>
1. **Clone the module starter**

   <Tabs>
     <TabItem label="Windows">
       ```powershell
       # Run the create script (recommended)
       .\create-module.ps1
       ```
     </TabItem>
     <TabItem label="macOS/Linux">
       ```bash
       # Run the create script (recommended)
       ./create-module.sh
       ```
     </TabItem>
     <TabItem label="Manual">
       ```bash
       git clone https://github.com/ui-git-kim/unique-react-fullstack-module-starter my-module
       cd my-module
       git remote rename origin scaffold-upstream
       mv CLAUDE.MODULE.md CLAUDE.md
       ```
     </TabItem>
   </Tabs>

   The create script:
   - Prompts for module name
   - Clones with git history (for scaffold updates)
   - Renames `origin` to `scaffold-upstream`
   - Updates `package.json` and `src/module.ts` with your module name
   - Installs dependencies
   - Creates initial commit

2. **Update module identity**

   Edit `package.json`:
   ```json
   {
     "name": "my-billing-module",
     "description": "Billing and subscription management",
     "bin": {
       "my-billing-module": "./dist/cli.js"
     }
   }
   ```

   Edit `src/module.ts`:
   ```typescript
   export const moduleDefinition: ModuleDefinition = {
     id: 'billing',              // kebab-case, used in file paths
     name: 'Billing',            // Human readable
     description: 'Billing and subscription management',
     version: '1.0.0',
     // ... templates configuration
   };
   ```

3. **Write your templates**

   Templates live in `src/templates/`. See [Code Templates](/module-starter/templates/) for examples.

4. **Build and test**

   ```bash
   npm run build
   npm link

   # In a starter project
   cd ../my-app
   npx my-billing-module init
   ```

5. **Publish** (optional)

   ```bash
   npm run release:patch    # Creates git tag
   npm publish              # Publish to npm
   ```
</Steps>

---

## The Create Script

The `create-module.ps1` (Windows) or `create-module.sh` (macOS/Linux) script automates module setup:

### What It Does

1. **Prompts for module name** - Accepts any format, converts to kebab-case
2. **Prompts for save location** - Defaults to parent directory
3. **Clones via git** - Preserves history for scaffold updates
4. **Configures remotes** - Renames `origin` to `scaffold-upstream`
5. **Removes scaffold-only files** - `create-module.ps1`, `create-module.sh`, etc.
6. **Renames CLAUDE files** - `CLAUDE.MODULE.md` becomes `CLAUDE.md`
7. **Updates configuration** - `package.json`, `src/module.ts`, `README.md`
8. **Installs dependencies** - Runs `npm install`
9. **Creates initial commit** - Clean starting point

### Name Conversion

The script converts any input to kebab-case:

| Input | Converted |
|-------|-----------|
| `My Feature` | `my-feature` |
| `AI_Chat_Bot` | `ai-chat-bot` |
| `billingModule` | `billing-module` |

---

## Module Configuration

The `src/module.ts` file defines everything about your module:

```typescript
import { ModuleDefinition } from './scaffold/types.js';
import { SCHEMA_TEMPLATE } from './templates/schema.js';
import * as frontend from './templates/frontend/index.js';
import * as backend from './templates/backend/index.js';

export const moduleDefinition: ModuleDefinition = {
  // Identity
  id: 'billing',
  name: 'Billing',
  description: 'Billing and subscription management',
  version: '1.0.0',

  // Database schema (optional)
  schema: {
    content: SCHEMA_TEMPLATE,
    modelNames: ['billing_subscription', 'billing_invoice'],
  },

  // Frontend configuration
  frontend: {
    directories: ['pages', 'components', 'hooks', 'services'],
    templates: [
      { path: 'index.ts', content: frontend.INDEX_TEMPLATE },
      { path: 'navigation.registration.ts', content: frontend.NAVIGATION_REGISTRATION },
      { path: 'routes.config.tsx', content: frontend.ROUTES_CONFIG },
      { path: 'pages/BillingPage.tsx', content: frontend.PAGE_TEMPLATE },
    ],
    registrations: {
      navigation: true,
      dashboard: false,
      preferences: false,
      settingsPages: false,
    },
  },

  // Backend configuration
  backend: {
    directories: [],
    templates: [
      { path: 'index.ts', content: backend.INDEX_TEMPLATE },
      { path: 'billing.routes.ts', content: backend.ROUTES_TEMPLATE },
      { path: 'billing.service.ts', content: backend.SERVICE_TEMPLATE },
      { path: 'route.registration.ts', content: backend.ROUTE_REGISTRATION },
      { path: 'service.registration.ts', content: backend.SERVICE_REGISTRATION },
    ],
    registrations: {
      routes: true,
      services: true,
    },
  },

  // Interactive prompts (optional)
  prompts: [
    {
      id: 'provider',
      type: 'select',
      question: 'Which payment provider?',
      options: [
        { value: 'stripe', label: 'Stripe' },
        { value: 'paddle', label: 'Paddle' },
      ],
      default: 'stripe',
    },
  ],

  // Environment variables (optional)
  envVariables: [
    {
      name: 'STRIPE_SECRET_KEY',
      description: 'Stripe secret API key',
      required: true,
      secret: true,
    },
  ],

  // Dependencies (optional)
  dependencies: {
    shadcnComponents: ['card', 'button', 'badge'],
    dependencies: ['stripe'],
  },
};
```

---

## Template Placeholders

Templates use placeholder patterns that get replaced during installation:

### Name Patterns

| Pattern | Replaced With | Example |
|---------|--------------|---------|
| `my-feature` | Module ID (kebab) | `billing` |
| `myFeature` | camelCase | `billing` |
| `MyFeature` | PascalCase | `Billing` |
| `my_feature` | snake_case | `billing` |

### Variable Substitution

Use `{{variableName}}` for values from prompts:

```typescript
// Template
const provider = '{{provider}}';
const apiKey = process.env.{{apiKeyEnvVar}};

// With default fallback
const timeout = {{timeout|5000}};
```

### Example Template

```typescript
// src/templates/frontend/pages.ts
export const PAGE_TEMPLATE = `// ========================================================================
// FILE: frontend/src/features/my-feature/pages/MyFeaturePage.tsx
// PURPOSE: Main page for my-feature
// ========================================================================

import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';

export function MyFeaturePage() {
  return (
    <div>
      <div className="mb-6">
        <h1 className="text-xl font-semibold">My Feature</h1>
      </div>
      <Card>
        <CardHeader>
          <CardTitle>Welcome</CardTitle>
        </CardHeader>
        <CardContent>
          <p>My Feature is ready to use.</p>
        </CardContent>
      </Card>
    </div>
  );
}
`;
```

---

## Testing Your Module

<Steps>
1. **Build the module**
   ```bash
   npm run build
   ```

2. **Link locally**
   ```bash
   npm link
   ```

3. **Create a test app** (or use existing)
   ```bash
   # In another terminal
   cd ../my-test-app
   ```

4. **Install your module**
   ```bash
   npx my-billing-module init
   ```

5. **Verify installation**
   - Check `frontend/src/features/billing/` exists
   - Check `backend/src/features/billing/` exists
   - Run the app: `npm run dev`
   - Navigate to your module's page
</Steps>

---

## Updating from Module Starter

When the module starter improves (bug fixes, new features, template improvements), you can pull those changes into your module. This works the same way the starter template updates propagate to apps.

### How It Works

The create script preserves git history and sets up `scaffold-upstream` as a remote pointing back to the module starter. This enables standard git merge to pull in changes.

```bash
# Check what's changed
npm run scaffold:check

# Merge updates
npm run scaffold:update
```

The update script will:
1. Fetch the latest module starter from `scaffold-upstream`
2. Show available commits and version differences
3. Merge changes via git
4. Handle conflicts (if any)

### What Gets Updated

| Updated (module starter infrastructure) | Preserved (your code) |
|-----------------------------------------|----------------------|
| `src/scaffold/*` — init, update, uninstall logic | `src/templates/*` — your custom templates |
| `src/cli.ts` — CLI entry point | `src/module.ts` — your module configuration |
| `scripts/*` — build and version scripts | `package.json` — your module name and deps |
| `tsconfig.json`, `tsup.config.ts` — build config | `CLAUDE.md` — your module-specific instructions |
| `VERSION` — scaffold version | `.env` files |

### Handling Conflicts

If both you and the module starter modified the same file, git will flag a conflict:

```bash
# Keep your version
git checkout --ours path/to/file

# Take module starter version
git checkout --theirs path/to/file

# After resolving
git add path/to/file
git commit
```

<Aside type="tip">
Scaffold updates primarily affect `src/scaffold/` and build infrastructure. Your templates in `src/templates/` are yours — the module starter only provides the initial starting point. Conflicts are rare because the scaffold files are marked "DO NOT EDIT".
</Aside>

<Aside type="note">
For a full explanation of versioning and how updates flow through the system, see [Versioning and Update System](/module-starter/#versioning-and-update-system).
</Aside>

---

## Publishing

### Version Bump

Before publishing, bump the version:

```bash
npm run release:patch    # Bug fixes
npm run release:minor    # New features
npm run release:major    # Breaking changes
```

This updates both `package.json` and `src/module.ts`, commits, and creates a git tag.

### npm Publish

```bash
npm publish
```

Users can then install with:

```bash
npx my-billing-module init
```

---

## Next Steps

- [Module Structure](/module-starter/module-structure/) - Detailed file reference
- [Code Templates](/module-starter/templates/) - Copy-paste templates
- [Lifecycle Hooks](/module-starter/lifecycle-hooks/) - Filters and actions
